---
sidebar_position: 88
title: MP3
description: MP3 - High-quality DUELink module
hide_table_of_contents: true
pagination_next: null
pagination_prev: null
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ImageSection from '@site/src/components/ImageSection';
import OrderSection from '@site/src/components/OrderSection';

# MP3

<ImageSection 
  product="somp3-a"
  tagline="MP3 Micro SD Player"
/>

---

<Tabs className="unique-tabs" groupid="catalog" queryString="show" defaultValue="overview"
  values={[
    {
        label: "Overview",
        value: "overview"
    },
    {
        label: "Drivers",
        value: "drivers"
    },
    {
        label: "Samples",
        value: "samples"
    }
]}>

<TabItem value="overview">

Play MP3 audio/music from files found on the attached Micro SD card. The audio quality is reasonable and single mono channel. There is no system load as the module only receives and processes simple commands, like start playing, or stop. The files on the Micro SD card are saved in standard FAT16/FAT32 file system and can handle SD cards up to 32GB. Note that you will not have access to the files directly. Only the MP3 decoder can read the files. You will need to move the Micro SD card to a PC to load it with MP3 files.

Micro SD card is required and is not included.

<table><td width='50%'>
**Key features**

â€¢ MP3 decoder<br/>
â€¢ Auto playback<br/>
â€¢ Micro SD card reader<br/>
â€¢ 37x22mm Overall Dimension<br/>

</td><td width='50%'>
**Resources**
 
ðŸ“„[Schematics](/sch/gdl-somp3-a.pdf)<br/>
ðŸ”©[3D STEP file](/3d/gdl-somp3-a.step)<br/>
</td></table>

</TabItem>

<TabItem value="drivers">

See [Drivers](/docs/engine/drivers) page for further details.

| Function | Description |
|----------|-------------|
| `SendCmd(c, a)` | Send `c` command & `a` argument to mp3 module. |
| `WResponse(t, c, a)` | `t` timeout, `c` code, `a` argument. Wait for response. |
| `Stop()` | Stop playing. |
| `SetVol(v)` | Sets `v` volume. (Min 0, max 30) |
| `IsBusy()` | Returns 1 if busy. |
| `Loop(r)` | Sets `r` repeat. |
| `Rst()` | Reset mp3 module. |
| `PlayFile(f, d)` | Play file. `f` Files and `d` directories must be named in numerics. |
| `DVer()` | This driver version. |
<details>
<summary><strong>The Code!</strong></summary>

**MP3 Driver**

```batch
Alias(resp_to=2000, min_last=200, reset_to=3000, min_vol=0, max_vol=30, code_ok=0x41, code_err=0x40, code_done=0x3D, code_rdy=0x3F, last_sent = _l, busy_pin = 5, message=b2 )

##### MP3 Driver #####

fn DVer()
    return 1.0
fend

Dim b2[10] # buffer to send and read response
_l = 0 # last sent



fn Init()
    SerCfg(9600, 1024)
    DRead(busy_pin, 1) # busy pin, input pull up. Low mean busy
    _l = 0
    
    Wait(1500) # power up need 1.5 second for mp3 module initialize internally 
fend

fn SendCmd(c, a) 
    # Make sure not too short from last sent
    while ((TickMs() - last_sent) < min_last)
        Wait(1)
    wend
    
    message = [ 0x7E, 0xFF, 0x06, c, 0x01, (a >> 8) & 0xFF, a & 0xFF, 0x00, 0x00, 0xEF ]
    
    s = 0
    
    for i = 1 to 7
        s = s - message[i]
    next
    
    message[7] =  (s >> 8) & 0xFF
	message[8] =  s & 0xFF
	
	SerWrs(message)
	
	while (SerB2r() < 10)
	wend
	
	b = WResponse(resp_to, code_ok, -1)
	last_sent = TickMs()
	
	return b
fend

fn WResponse(t, c, a) 
    s = TickMs()
    
    message = [ 0x7E, 0xFF, 06, c, 0, 0, 0, 0, 0, 0xEF ]
    
    i = 0
    b = 0

    while (TickMs() - s < t)
        if (SerB2r() > 0)
            b = SerRd()
            if (b >= 0) 
                if message[i] = 0 || b = message[i]
                    i = i + 1
                else
                    i = 0
                end
                
                if (i = 10)
                    return 1
                end
                
            end
        end
        Wait(1)
        # check trigger pin no
    wend
    
    return 0
fend

fn Stop() 
    return SendCmd(0x16, 0)
fend

fn SetVol(v)
    return SendCmd(0x06, v)
fend

fn IsBusy()
    return !DRead(busy_pin, 1)
fend

fn Loop(r) # r: repeat
    return SendCmd(0x19, !r)
fend

fn Rst()
    if SendCmd(0x0C, 0)
        return WResponse(reset_to, code_rdy, -1)
    end
    return 0
fend

fn PlayFile(f, d)
    if (d = 0)
        return SendCmd(0x03, f)
    else
        return SendCmd(0x0f, (d << 8) | f)
    end
fend

Init()

####################
```

</details>

[See full driver on GitHub](https://github.com/ghi-electronics/duelink-website/tree/main/static/code/drivers)

</TabItem>

<TabItem value="samples">

### Python

```python
from DUELink.DUELinkController import DUELinkController
import time
availablePort = DUELinkController.GetConnectionPort()
duelink = DUELinkController(availablePort)
```

### JavaScript

```javascript
const { SerialUSB } = require("dlserialusb");
const { DUELinkController } = require("duelink");
```

### Script

```batch
if (Rst()) # reset module
    SetVol(30) # set volume to max
    if (PlayFile(1, 1)) # play file 001.mp3 in folder 01        
        PrintLn("File is playing.")
    end
else
    PrintLn("Reset failed.")
end

while (IsBusy()) # Busy mean playing
   wait(1)
wend

PrintLn("Play ended.")

```

[See full examples on GitHub](https://github.com/ghi-electronics/duelink-website/tree/main/static/code/samples)

</TabItem>

</Tabs>

---

<OrderSection
    product="DUELink MP3"
    partnumber="GDL-SOMP3-A"
    price="$0.00"
/>
