---
sidebar_position: 65
title: AirQuality
description: AirQuality - High-quality DUELink module
hide_table_of_contents: true
pagination_next: null
pagination_prev: null
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ImageSection from '@site/src/components/ImageSection';
import OrderSection from '@site/src/components/OrderSection';

# AirQuality

<ImageSection 
  product="seairquality-a"
  tagline="Air Quality Sensor"
/>

---

<Tabs className="unique-tabs" groupid="catalog" queryString="show" defaultValue="overview"
  values={[
    {
        label: "Overview",
        value: "overview"
    },
    {
        label: "Drivers",
        value: "drivers"
    },
    {
        label: "Samples",
        value: "samples"
    }
]}>

<TabItem value="overview">

This multi-gas digital sensor is used to detect surrounding air quality.

<table><td width='50%'>
**Key features**

â€¢ Reads air quality<br/>
â€¢ 37x27mm overall dimension<br/>

</td><td width='50%'>
**Resources**
 
ðŸ“„<a href="/sch/gdl-seairquality-a.pdf" download>Schematics</a><br/>
ðŸ”©<a href="/3d/gdl-seairquality-a.step" download>3D STEP file</a><br/>
</td></table>

</TabItem>

<TabItem value="drivers">

See [Drivers](/docs/engine/drivers) page for further details.

| Function | Description |
|----------|-------------|
| `AhtTemp()` | Returns ambient temperature in celsius. |
| `AhtHumid()` | Returns relative humidity. |
| `EnsAqi()` | Returns air quality index. |
| `EnsTvoc()` | Returns Total Volatile Organic Compounds. |
| `EnsEco2()` | Returns equivalent CO2. |
| `DVer()` | This driver version. |
<details>
<summary><strong>The Code!</strong></summary>

**AirQuality Driver**

```batch
##### AirQuality Driver #####

fn DVer()
    return 1.0
fend

# Includes ENS160 and AHT21
# eCO2 = equivalent CO2
# AQI = Air Quality Index
# TVOC = Total Volatile Organic Compounds

fn AhtSts()
    Dim b1[1] 
    I2cWr(0x38, 0, b1)  
    return b1[0]
fend

fn AhtInit() 
    Dim b1[1]    
    Wait(20)  
    b1[0] = 0xBA
    I2cWr(0x38, b1, 0) 
    Wait(20)
    
    while (AhtSts() & 0x80)
        Wait(20)
    wend

    while (!AhtSts() & 0x08)
        return 0
    wend
    
    return 1    
fend

fn AhtTemp()  
    I2cWr(0x38, [0xAC, 0x33, 0], 0)
    
    while (AhtSts() & 0x80)
        Wait(20)
    wend
    
    Dim b1[6]  
    I2cWr(0x38, 0, b1) 
    t = b1[3] & 0x0F
    t = t << 8
    t =t | b1[4]
    t = t << 8
    t = t | b1[5]
    return (t * 200 / 0x100000) - 50 
fend

fn AhtHumid()
    I2cWr(0x38, [0xAC, 0x33, 0], 0)
    
    while (AhtSts() & 0x80)
        Wait(20)
    wend
    
    Dim b1[6]  
    I2cWr(0x38, 0, b1)   
    h = b1[1] 
    h = h << 8
    h = h | b1[2]
    h = h << 4
    h = h | (b1[3] >> 4)
    return (h * 100) / 0x100000
fend

fn EnsWrt8(r, v)
    Dim b1[2] = [r, v]
    I2cWr(0x52, b1, 0)
    
fend

fn EnsRd8(r)
    Dim b1[1] = [r]
    I2cWr(0x52, b1, 0)
    
    I2cWr(0x52, 0, b1)
    return b1[0]
fend

fn EnsWrt(r, b1, l)
    Dim b2[l+1]
    
    b2[0] = r
    MemCpy(b2, 1, b1, 0, l)
    
    I2cWr(0x52, b2, 0)
fend

fn EnsRd(r, b1)
    I2cWr(0x52, [r], 0)
    I2cWr(0x52, 0, b1)
fend

fn EnsSetm(m)
    EnsWrt8(0x10, m)
fend

fn EnsWait()
   while (0x02 != (ensrd8(0x20) & 0x02))
        Wait(1)
    wend
fend

fn EnsAqi()
    EnsWait()
    
    Dim b1[7]
    I2cWr(0x52, [0x21], 0)
    I2cWr(0x52, 0, b1)
    
    return b1[0]
fend

fn EnsTvoc()
    EnsWait()
    
    Dim b1[7]
    I2cWr(0x52, [0x21], 0)
    I2cWr(0x52, 0, b1)
    
    return b1[1] | (b1[2] << 8)
fend

fn EnsEco2()
    enswait()
    
    Dim b1[7]
    I2cWr(0x52, [0x21], 0)
    I2cWr(0x52, 0, b1)

    return  b1[3] | (b1[4] << 8)
fend

fn EnsInit()
    DWrite(12,1) # high I2c
    DWrite(19, 0) # low: address 0x52
    DRead(13, 1)
    Wait(10)
    #reset
    EnsWrt8(0x10, 0xF0)
    Wait(10)

    #set mode ENS160_OPMODE_STD
    EnsSetm(0x02) 
fend

fn Init()
    I2cCfg(400)
    AhtInit() 
    EnsInit()
fend

Init()

#############################
```

</details>

[See full driver on GitHub](https://github.com/ghi-electronics/duelink-website/tree/main/static/code/drivers)

</TabItem>

<TabItem value="samples">

### Python

```python
from DUELink.DUELinkController import DUELinkController
import time
availablePort = DUELinkController.GetConnectionPort()
duelink = DUELinkController(availablePort)
```

### JavaScript

```javascript
const { SerialUSB } = require("dlserialusb");
const { DUELinkController } = require("duelink");
```

### Script

```batch
while (1) 
    PrintLn("temp: ",AhtTemp(),"C - humidity: ",AhtHumid(),"%")
    PrintLn("AQI: ",EnsAqi()," - TVOC: ",EnsTvoc()," - eCO2: ",EnsEco2())
    Wait(2000)
wend
```

[See full examples on GitHub](https://github.com/ghi-electronics/duelink-website/tree/main/static/code/samples)

</TabItem>

</Tabs>

---

<OrderSection
    product="DUELink AirQuality"
    partnumber="GDL-SEAIRQUALITY-A"
    price="$0.00"
/>
