"use strict";(self.webpackChunkduelink=self.webpackChunkduelink||[]).push([[8582],{8403:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"loader","title":"Loader","description":"---","source":"@site/docs/loader.mdx","sourceDirName":".","slug":"/loader","permalink":"/docs/loader","draft":false,"unlisted":false,"editUrl":"https://github.com/ghi-electronics/duelink-website/tree/dev/docs/loader.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Console","permalink":"/docs/console"},"next":{"title":"Specifications","permalink":"/docs/specs"}}');var s=o(4848),i=o(8453);const r={},d="Loader",l={},a=[{value:"Update Options",id:"update-options",level:2},{value:"Entering the Loader",id:"entering-the-loader",level:2},{value:"Console Update",id:"console-update",level:2},{value:"STM32 Tools Update",id:"stm32-tools-update",level:2},{value:"I2C &amp; UART Update",id:"i2c--uart-update",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"loader",children:"Loader"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["The STM32C071 chip utilized on all DUELink modules include an ST loader that we utilize for firmware updates using the ",(0,s.jsx)(n.code,{children:"USB DFU"})," standard."]}),"\n",(0,s.jsxs)(n.p,{children:['The loaded "firmware" can be the official  DUELink or MicroBlocks. It can also be a custom firmware built using ',(0,s.jsx)(n.a,{href:"./language/cpp",children:"C++"})," language page. The ",(0,s.jsx)(n.a,{href:"./hw/arduino",children:"Arduino"})," IDE can also be used to build custom firmware; however, the IDE has a built-in DFU upload capability."]}),"\n",(0,s.jsx)(n.h2,{id:"update-options",children:"Update Options"}),"\n",(0,s.jsxs)(n.p,{children:["Users have two options for firmware updates. We recommend using the ",(0,s.jsx)(n.a,{href:"./console",children:"Console"})," as a first choice."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/console-firmware.png",alt:"DUELink Console Firmware Menu"})}),"\n",(0,s.jsxs)(n.p,{children:["Advance users can also use the ",(0,s.jsx)(n.a,{href:"https://www.st.com/en/development-tools/stm32cubeprog.html",children:"STM32CubeProgrammer"})," tool."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/stm-select-usb.png",alt:"Select USB"})}),"\n",(0,s.jsx)(n.p,{children:"Either way, the first step is in placing the board in loader mode (Entering the Loader!)."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"entering-the-loader",children:"Entering the Loader"}),"\n",(0,s.jsxs)(n.p,{children:["The standard DUELink software includes ",(0,s.jsx)(n.code,{children:"Reset(1)"})," that wipes out the chip completely and; therefore, forcing it in the loader mode. Since this is a critical command ",(0,s.jsx)(n.code,{children:"Reset(1)"})," MUST BE called twice. You can send this command over any interface. An easy way would be to use the ",(0,s.jsx)(n.a,{href:"./console",children:"Console"})," immediate window."]}),"\n",(0,s.jsxs)(n.p,{children:["The other option is done using hardware. Locate the ",(0,s.jsx)(n.code,{children:"LDR"})," button on your module. On some board, the ",(0,s.jsx)(n.code,{children:"LDR"})," button is labeled with ",(0,s.jsx)(n.code,{children:"A"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/ldr-a-buttons.png",alt:"Setting Boot mode mode"})}),"\n",(0,s.jsxs)(n.p,{children:["Press and ",(0,s.jsx)(n.strong,{children:"continue to hold"})," the button while resetting the board. If there is no reset button, then unplug the USB cable first, then hold the button down while inserting the USB cable. Wait one second after the cable is inserted then release the button."]}),"\n",(0,s.jsxs)(n.p,{children:["If neither ",(0,s.jsx)(n.code,{children:"LDR"})," nor ",(0,s.jsx)(n.code,{children:"A"})," button is available, then the LDR pads are found on small through-hole pads. Bend and place a small metal paper clip (or a wire) between these 2 pads, and reset/repower the board. You can remove the paper clip after the board is powered up."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/boot-mode.png",alt:"Setting Boot mode"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"LDR is the name we use for STM32's BOOT0 pin, which is button A or LDR in some cases."})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"console-update",children:"Console Update"}),"\n",(0,s.jsxs)(n.p,{children:["Once the device is in the loader mode, the system will detect a USB ",(0,s.jsx)(n.code,{children:"DFU in FS Mode"})," device."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/device-manager-dfu.png",alt:"Verify DFU mode"})}),"\n",(0,s.jsxs)(n.p,{children:["From ",(0,s.jsx)(n.a,{href:"https://console.duelink.com/",children:"https://console.duelink.com/"}),", click ",(0,s.jsx)(n.code,{children:"Firmware"})," on the top menu."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/due-firmware.png",alt:"DUELink Console Firmware Menu"})}),"\n",(0,s.jsx)(n.p,{children:"Follow the instructions to update the firmware. Which is basically done by selecting the desired firmware file."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"stm32-tools-update",children:"STM32 Tools Update"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://www.st.com/en/development-tools/stm32cubeprog.html",children:"STM32CubeProgrammer"})," tool is good advanced option."]}),"\n",(0,s.jsxs)(n.p,{children:["First, download the desired firmware file from the ",(0,s.jsx)(n.a,{href:"downloads",children:"Downloads"})," page. Connect the module and enter the loader mode, as explained before."]}),"\n",(0,s.jsxs)(n.p,{children:["STM32CubeProgrammer will now detect a USB DFU device, select ",(0,s.jsx)(n.code,{children:"USB"})," from the drop down and click ",(0,s.jsx)(n.code,{children:"Connect"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/stm-select-usb.png",alt:"Select USB"})}),"\n",(0,s.jsxs)(n.p,{children:["Click on the side tab then select the file you downloaded from the ",(0,s.jsx)(n.a,{href:"downloads",children:"Download"})," page, then click ",(0,s.jsx)(n.code,{children:"Start Programming"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"/img/stm-selectfile-program.png",alt:"Select file"})}),"\n",(0,s.jsx)(n.p,{children:"The board now has the desired file loaded!"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"i2c--uart-update",children:"I2C & UART Update"}),"\n",(0,s.jsx)(n.p,{children:"This page focuses on firmware updates using USB DFU mode. We recommend to always use USB DFU when possible; however, using I2C and UART to send firmware updates are other possible options."}),"\n",(0,s.jsxs)(n.p,{children:['The "',(0,s.jsx)(n.a,{href:"https://www.st.com/resource/en/application_note/an2606-stm32-microcontroller-system-memory-boot-mode-stmicroelectronics.pdf",children:"STM32 microcontroller system memory boot mode"}),'" application note covers all the needed details.']})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);